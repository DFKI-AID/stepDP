<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Hello There</title>
    <meta name="description" content="Hello!">
    <meta name="author" content="Yannick KÃ¶rber">

    <div id="simulation" class="btn-grou">
        <button v-on:click="undo">undo</button>
        <button v-on:click="hello">hello</button>
        <button v-on:click="repeat">repeat</button>
        <button v-on:click="showTasks">show_tasks</button>
        <button v-on:click="selectTask">select_task</button>
        <button v-on:click="selectTaskSupp">select_task_supp</button>
        <button v-on:click="acceptTask">accept_task</button>
        <button v-on:click="accept">accept</button>
        <button v-on:click="reject">reject</button>
    </div>

    <!--<link rel="stylesheet" href="css/styles.css?v=1.0">-->
    <div id="app">
        <h2>iteration={{iteration}}</h2>

        <table>
            <tr>
                <th>name</th>
                <th>active</th>
                <th>priority</th>
            </tr>
            <tr v-for="item in rules">
                <td>{{item.name}}</td>
                <td>{{item.active}}</td>
                <td>{{item.priority}}</td>
            </tr>
        </table>

        <div>Tokens: {{tokens}}</div>

        <div>Grammar: {{grammar}}</div>

    </div>


</head>

<body>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.22/dist/vue.js"></script>
<script>
    const app = new Vue({
        el: '#app',
        data: {
            interval: null,
            iteration: 0,
            rules: [],
            tokens: [],
            grammar: null
        },
        methods: {
            updateData: function () {
                $.get('/iteration', function (response) {
                    this.iteration = response.iteration;
                }.bind(this));

                $.get('/rules', function (response) {
                    this.rules = response;
                }.bind(this));

                $.get('/tokens', function (rsp) {
                    this.tokens = rsp;
                }.bind(this));

                $.get('/grammar', function (rsp) {
                    this.grammar = new XMLSerializer().serializeToString(rsp);
                }.bind(this));
            }
            // simHello: function (event) {
            //     var payload = {intent: "hello"};
            //     $.post("/input/intent", payload);
            // },
            // simRepeat: function (event) {
            //     var payload = {intent: "repeat"};
            //     $.post("/input/intent", payload);
            // },
            // simAvailableTasks: function (event) {
            //     var payload = {intent: "available_tasks"};
            //     $.post("/input/intent", payload);
            // },
            // selectTask: function (event) {
            //     var payload = {intent: "select_task", task: "first"};
            //     $.post("/input/intent", payload);
            // }
        },
        created() {
            this.updateData();
            this.interval = setInterval(function () {
                this.updateData();
            }.bind(this), 250);
        }
        // created() {
        //     fetch('http://localhost:50000/rules')
        //         .then(rsp => rsp.json())
        //         .then(json => {
        //             this.items = json
        //         })
        //     fetch('http://localhost:50000/iteration')
        //         .then(rsp => rsp.json())
        //         .then(json => this.iteration = json.iteration)
        // },
    });
</script>
<script>
    const simulation = new Vue({
        el: '#simulation',
        methods: {
            undo: function (event) {
                var payload = {intent: "undo"};
                $.post("/input/intent", payload);
            },
            hello: function (event) {
                var payload = {intent: "greetings"};
                $.post("/input/intent", payload);
            },
            repeat: function (event) {
                var payload = {intent: "repeat"};
                $.post("/input/intent", payload);
            },
            selectTask: function (event) {
                var payload = {intent: "select_task"};
                $.post("/input/intent", payload);
            },
            acceptTask: function (event) {
                var payload = {intent: "accept_task"};
                $.post("/input/intent", payload);
            },
            selectTaskSupp: function (event) {
                var payload = {intent: "select_task_supp", task: "third"};
                $.post("/input/intent", payload);
            },
            showTasks: function (event) {
                var payload = {intent: "show_tasks"};
                $.post("/input/intent", payload);
            },
            accept: function (event) {
                var payload = {intent: "accept"};
                $.post("/input/intent", payload);
            },
            reject: function (event) {
                var payload = {intent: "reject"};
                $.post("/input/intent", payload);
            }
        }, created() {
        }
    });
</script>
</body>
</html>